#!/usr/bin/env bash
# Automatic development environment activation with direnv
# This prevents ALL dependency issues by loading everything automatically

# Use the complete nix shell
use nix shell-complete.nix

# Set project-specific environment variables
export NIX_HUMANITY_DEV=true
export NIX_HUMANITY_PYTHON_BACKEND=true
export PYTHONPATH="$PWD/src:$PYTHONPATH"

# Load local environment overrides if they exist
if [ -f .env.local ]; then
    source .env.local
fi

# Helpful welcome message
echo "ðŸŒŠ Sacred development environment activated!"
echo "   All dependencies loaded automatically"
echo "   No more interruptions to your flow!"

# Watch for changes to rebuild automatically
watch_file shell-complete.nix
watch_file pyproject.toml
watch_file poetry.lock