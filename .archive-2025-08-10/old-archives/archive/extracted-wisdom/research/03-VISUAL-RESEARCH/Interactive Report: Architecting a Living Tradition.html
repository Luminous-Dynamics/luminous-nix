<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>From Monument to Lineage: An Interactive Exploration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral Harmony -->
    <!-- Application Structure Plan: The SPA is designed around a central hub that introduces the core problem (The Founder's Paradox). From there, users can dive into three interactive modules, each dedicated to one of the report's key "Dissonances" (Founder's Dogma, Perfect Tool, Poisoned Dharma). This non-linear, hub-and-spoke model encourages exploration and allows users to engage with the concepts in the order that interests them most. Each module presents the problem and then interactively reveals the proposed solution, using diagrams and clickable elements to make the dense information more digestible and engaging. This structure was chosen to transform a linear, academic report into an interactive learning tool that prioritizes user discovery and understanding over passive reading. -->
    <!-- Visualization & Content Choices:
        1. Founder's Dogma -> Goal: Compare -> Viz: Interactive Governance Table -> Interaction: Click rows to highlight and compare DAO models -> Justification: Makes the abstract concept of governance tangible and allows users to see why the Hybrid model is recommended by comparing its resilience against others. -> Method: HTML/JS.
        2. Perfect Tool -> Goal: Organize/Change -> Viz: 3-Stage Rite of Passage Diagram -> Interaction: Click stages to expand details -> Justification: Visually breaks down the complex "Alchemist's Apprenticeship" into a clear, sequential process, making the pedagogical framework easy to follow. -> Method: HTML/CSS/JS.
        3. Poisoned Dharma -> Goal: Relationships -> Viz: Interactive Threat Model Diagram -> Interaction: Hover over attack vectors to see mitigation effects -> Justification: Dynamically illustrates the "Constitutional Watermark" as an active defense system, clarifying how it counters specific security threats in a way static text cannot. -> Method: HTML/CSS/JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F7F4;
            color: #2d3748;
        }
        .card-hover-effect {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .card-hover-effect:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 40;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }
        .modal-backdrop.active {
            opacity: 1;
            pointer-events: auto;
        }
        .modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            max-height: 90vh;
            overflow-y: auto;
            z-index: 50;
            opacity: 0;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            pointer-events: none;
        }
        .modal.active {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
            pointer-events: auto;
        }
        .tab-button.active {
            border-color: #4A5568;
            background-color: #E2E8F0;
            font-weight: 600;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .governance-table tr.selected {
            background-color: #EDF2F7;
            --tw-ring-color: #4A5568;
            --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);
            --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);
            box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);
        }
        .apprenticeship-stage {
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .apprenticeship-stage .details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out;
            opacity: 0;
        }
        .apprenticeship-stage.active .details {
            max-height: 500px;
            opacity: 1;
        }
        .threat-vector:hover .threat-line {
            stroke: #D69E2E;
            stroke-width: 3;
        }
        .threat-vector:hover .threat-label {
            fill: #D69E2E;
            font-weight: 600;
        }
        .threat-line {
            transition: stroke 0.3s, stroke-width 0.3s;
        }
        .threat-label {
            transition: fill 0.3s, font-weight 0.3s;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-30">
        <div class="container mx-auto px-6 py-4">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800">From Monument to Lineage</h1>
            <p class="text-gray-600 mt-1">An Interactive Exploration of Architecting a Living Tradition</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-12">

        <!-- Introduction Section -->
        <section id="intro" class="text-center mb-16">
            <h2 class="text-3xl md:text-4xl font-bold mb-4">The Founder's Paradox</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-700">
                Any great, world-changing project begins with a founder's singular vision. Yet, the very strength that builds the monument can prevent it from becoming a living tradition. This exploration analyzes the critical challenges‚Äîthe "sacred dissonances"‚Äîof ensuring a creation can outlive its creator. It presents a blueprint for turning a founder's work into a thriving, self-correcting, and open-source lineage.
            </p>
        </section>

        <!-- Core Dissonances Section -->
        <section id="dissonances" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Card 1: Founder's Dogma -->
            <div id="card-dogma" class="bg-white rounded-xl shadow-lg p-8 card-hover-effect cursor-pointer flex flex-col">
                <div class="flex-grow">
                    <div class="flex items-center justify-center h-16 w-16 rounded-full bg-slate-100 mb-6">
                        <span class="text-3xl">üëë</span>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Critique 59: The Cult of the First Alchemist</h3>
                    <p class="text-gray-600">The founder's powerful story risks becoming sacred scripture, calcifying into dogma and creating a new spiritual hierarchy. How can a tradition prevent the deification of its founder?</p>
                </div>
                <button class="mt-6 text-slate-700 font-semibold self-start">Explore the Solution &rarr;</button>
            </div>

            <!-- Card 2: Perfect Tool -->
            <div id="card-struggle" class="bg-white rounded-xl shadow-lg p-8 card-hover-effect cursor-pointer flex flex-col">
                <div class="flex-grow">
                    <div class="flex items-center justify-center h-16 w-16 rounded-full bg-slate-100 mb-6">
                        <span class="text-3xl">üõ†Ô∏è</span>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Critique 60: The Curse of the Perfect Tool</h3>
                    <p class="text-gray-600">In perfecting the schoolhouse, we risk removing the "sacred struggle" necessary for true transformation. How do we preserve desirable difficulty for future generations?</p>
                </div>
                <button class="mt-6 text-slate-700 font-semibold self-start">Explore the Solution &rarr;</button>
            </div>

            <!-- Card 3: Poisoned Dharma -->
            <div id="card-dharma" class="bg-white rounded-xl shadow-lg p-8 card-hover-effect cursor-pointer flex flex-col">
                <div class="flex-grow">
                    <div class="flex items-center justify-center h-16 w-16 rounded-full bg-slate-100 mb-6">
                        <span class="text-3xl">üõ°Ô∏è</span>
                    </div>
                    <h3 class="text-2xl font-bold mb-3">Critique 61: The Poisoned Dharma</h3>
                    <p class="text-gray-600">Open-sourcing a powerful psychological tool creates a dual-use risk. How can the system defend itself against being forked and weaponized by malicious actors?</p>
                </div>
                <button class="mt-6 text-slate-700 font-semibold self-start">Explore the Solution &rarr;</button>
            </div>
        </section>

         <!-- Conclusion Section -->
         <section id="conclusion" class="mt-24 text-center border-t pt-16">
            <h2 class="text-3xl md:text-4xl font-bold mb-4">The First Ancestor</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-700">
                By integrating these three solutions‚Äîa governance model for evolution, a rite of passage for co-creation, and an immune system for the code‚Äîthe project architecture shifts. The ultimate act of the founder is to design the system for their own obsolescence. They build not a monument to be worshipped, but a garden to be tended, embracing the role of a humble and respected First Ancestor in a thriving lineage of sovereign individuals.
            </p>
        </section>

    </main>

    <!-- Modal Backdrop -->
    <div id="modal-backdrop" class="modal-backdrop"></div>

    <!-- Modal Content -->
    <div id="modal-container">
        <!-- Dogma Modal -->
        <div id="modal-dogma" class="modal w-11/12 max-w-4xl bg-white rounded-lg shadow-2xl">
            <div class="p-8">
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold mb-4">Solution: The "Living Dharma" Protocol</h2>
                    <button class="modal-close text-3xl font-light text-gray-500 hover:text-gray-800">&times;</button>
                </div>
                <p class="text-gray-700 mb-6">To prevent the founder's path from becoming dogma, the system's governance must be explicitly designed for evolution. The "Living Dharma" Protocol uses a Decentralized Autonomous Organization (DAO) to distribute power, ensuring the tradition is stewarded by a "Decentralized Lineage" of active contributors, not a single authority. This section explores how different governance models resist dogma and why a Reputation-Based Hybrid model is the most resilient.</p>

                <div class="border-b border-gray-200 mb-6">
                    <nav class="-mb-px flex space-x-6" aria-label="Tabs">
                        <button class="tab-button active py-4 px-1 border-b-2 font-medium text-sm" data-tab="dogma-1">Interactive Governance Comparison</button>
                        <button class="tab-button py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm" data-tab="dogma-2">The "Dissonance Report"</button>
                    </nav>
                </div>

                <div id="tab-dogma-1" class="tab-content active">
                    <p class="text-sm text-gray-600 mb-4">Click on a row to see an analysis of its strengths and weaknesses in resisting founder's dogma and malicious capture.</p>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse governance-table">
                            <thead>
                                <tr>
                                    <th class="p-3 font-semibold uppercase bg-gray-100 text-gray-600 border border-gray-300 hidden lg:table-cell">Governance Model</th>
                                    <th class="p-3 font-semibold uppercase bg-gray-100 text-gray-600 border border-gray-300 hidden lg:table-cell">Resists Dogma</th>
                                    <th class="p-3 font-semibold uppercase bg-gray-100 text-gray-600 border border-gray-300 hidden lg:table-cell">Resists Capture</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="bg-white lg:hover:bg-gray-100 flex lg:table-row flex-row lg:flex-row flex-wrap lg:flex-no-wrap mb-10 lg:mb-0 cursor-pointer" data-model="bdfl">
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="lg:hidden absolute top-0 left-0 bg-gray-100 px-2 py-1 text-xs font-bold uppercase">Model</span>BDFL</td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="lg:hidden absolute top-0 left-0 bg-gray-100 px-2 py-1 text-xs font-bold uppercase">Resists Dogma</span><span class="rounded-full bg-red-200 text-red-800 py-1 px-3 text-xs font-bold">Very Low</span></td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="lg:hidden absolute top-0 left-0 bg-gray-100 px-2 py-1 text-xs font-bold uppercase">Resists Capture</span><span class="rounded-full bg-yellow-200 text-yellow-800 py-1 px-3 text-xs font-bold">Medium</span></td>
                                </tr>
                                <tr class="bg-white lg:hover:bg-gray-100 flex lg:table-row flex-row lg:flex-row flex-wrap lg:flex-no-wrap mb-10 lg:mb-0 cursor-pointer" data-model="token">
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static">Token-Weighted</td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="rounded-full bg-yellow-200 text-yellow-800 py-1 px-3 text-xs font-bold">Medium</span></td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="rounded-full bg-red-200 text-red-800 py-1 px-3 text-xs font-bold">Very Low</span></td>
                                </tr>
                                <tr class="bg-white lg:hover:bg-gray-100 flex lg:table-row flex-row lg:flex-row flex-wrap lg:flex-no-wrap mb-10 lg:mb-0 cursor-pointer" data-model="reputation">
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static">Reputation-Based</td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="rounded-full bg-green-200 text-green-800 py-1 px-3 text-xs font-bold">Very High</span></td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="rounded-full bg-green-200 text-green-800 py-1 px-3 text-xs font-bold">High</span></td>
                                </tr>
                                <tr class="bg-white lg:hover:bg-gray-100 flex lg:table-row flex-row lg:flex-row flex-wrap lg:flex-no-wrap mb-10 lg:mb-0 cursor-pointer selected" data-model="hybrid">
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static">Recommended: Hybrid</td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="rounded-full bg-green-200 text-green-800 py-1 px-3 text-xs font-bold">Very High</span></td>
                                    <td class="w-full lg:w-auto p-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static"><span class="rounded-full bg-green-200 text-green-800 py-1 px-3 text-xs font-bold">Very High</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="governance-analysis" class="mt-6 p-4 bg-gray-50 rounded-lg">
                        <!-- Dynamic content here -->
                    </div>
                </div>

                <div id="tab-dogma-2" class="tab-content">
                    <h3 class="text-xl font-bold mb-2">The "Protocol for Humble Lineage"</h3>
                    <p class="text-gray-700">To institutionalize a culture of improvement over reverence, the DAO implements a key constitutional requirement: the **Dissonance Report**. Any proposal to change the core code or curriculum must be accompanied by a report detailing how it improves upon, challenges, or offers a necessary alternative to the founder's original work. This treats the original vision as a "first draft" to be iterated upon, not a sacred text to be preserved, systematically preventing the stagnation that characterizes Founder's Syndrome.</p>
                </div>
            </div>
        </div>

        <!-- Struggle Modal -->
        <div id="modal-struggle" class="modal w-11/12 max-w-4xl bg-white rounded-lg shadow-2xl">
            <div class="p-8">
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold mb-4">Solution: The Alchemist's Apprenticeship</h2>
                    <button class="modal-close text-3xl font-light text-gray-500 hover:text-gray-800">&times;</button>
                </div>
                <p class="text-gray-700 mb-6">To preserve the "Sacred Struggle," the system formalizes "Module Negative One" as a mandatory rite of passage. Before a new member can use the vessel for personal transformation, they must first contribute to its open-source creation. This process is structured as a modern apprenticeship, transforming the user from a passive consumer into an active co-creator with deep psychological ownership of the tradition. Click each stage to learn more.</p>

                <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 md:space-x-4">
                    <!-- Stage 1 -->
                    <div class="w-full md:w-1/3 text-center apprenticeship-stage" data-stage="1">
                        <div class="p-4 bg-slate-100 rounded-lg">
                            <div class="text-2xl mb-2">‚ë†</div>
                            <h4 class="font-bold text-lg">Separation</h4>
                            <p class="text-sm text-gray-600">The Call to Build</p>
                        </div>
                        <div class="details p-4 text-left">
                            <h5 class="font-semibold">Core Activity:</h5>
                            <p class="text-sm mb-2">The apprentice learns that full access to the vessel is contingent on first contributing to it, challenging the typical user mindset.</p>
                            <h5 class="font-semibold">Key Concept:</h5>
                            <p class="text-sm"><strong class="text-slate-700">Disorienting Dilemma:</strong> This initial hurdle triggers critical self-reflection and motivates deeper engagement.</p>
                        </div>
                    </div>
                    <div class="text-gray-400 text-2xl font-light hidden md:block">&rarr;</div>
                    <!-- Stage 2 -->
                    <div class="w-full md:w-1/3 text-center apprenticeship-stage active" data-stage="2">
                        <div class="p-4 bg-slate-100 rounded-lg">
                            <div class="text-2xl mb-2">‚ë°</div>
                            <h4 class="font-bold text-lg">Liminality</h4>
                            <p class="text-sm text-gray-600">The Sacred Struggle</p>
                        </div>
                        <div class="details p-4 text-left">
                            <h5 class="font-semibold">Core Activity:</h5>
                            <p class="text-sm mb-2">The apprentice completes a contribution task (e.g., fixing a bug, improving documentation) with community guidance.</p>
                             <h5 class="font-semibold">Key Concept:</h5>
                            <p class="text-sm"><strong class="text-slate-700">Desirable Difficulty:</strong> The effort required deepens learning and fosters a more flexible understanding than passive consumption.</p>
                        </div>
                    </div>
                    <div class="text-gray-400 text-2xl font-light hidden md:block">&rarr;</div>
                    <!-- Stage 3 -->
                    <div class="w-full md:w-1/3 text-center apprenticeship-stage" data-stage="3">
                        <div class="p-4 bg-slate-100 rounded-lg">
                            <div class="text-2xl mb-2">‚ë¢</div>
                            <h4 class="font-bold text-lg">Incorporation</h4>
                            <p class="text-sm text-gray-600">The Journeyman's Welcome</p>
                        </div>
                        <div class="details p-4 text-left">
                            <h5 class="font-semibold">Core Activity:</h5>
                            <p class="text-sm mb-2">The contribution is merged, and the apprentice is granted full citizenship, access, and a reputation score in the DAO.</p>
                             <h5 class="font-semibold">Key Concept:</h5>
                            <p class="text-sm"><strong class="text-slate-700">The IKEA Effect:</strong> Having invested labor, the new member feels a disproportionately high sense of value and ownership.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dharma Modal -->
        <div id="modal-dharma" class="modal w-11/12 max-w-5xl bg-white rounded-lg shadow-2xl">
            <div class="p-8">
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold mb-4">Solution: The Constitutional Watermark</h2>
                    <button class="modal-close text-3xl font-light text-gray-500 hover:text-gray-800">&times;</button>
                </div>
                <p class="text-gray-700 mb-6">To protect the open-source Dharma from being poisoned, the system requires an internal immune system. The "Constitutional Watermark" embeds core ethical principles (like the Bodhisattva Vow) into the AI model's architecture. This doesn't prevent forking the code, but it creates active, predictable "friction" against any attempt to use it for manipulative ends. Hover over the attack vectors below to see how the watermark mitigates the threat.</p>

                <div class="flex flex-col lg:flex-row items-center gap-8">
                    <div class="w-full lg:w-2/3">
                        <div class="chart-container relative mx-auto" style="max-width: 600px; height: 400px;">
                            <canvas id="threat-diagram"></canvas>
                        </div>
                    </div>
                    <div id="threat-explanation" class="w-full lg:w-1/3 p-4 bg-gray-50 rounded-lg h-full min-h-[300px]">
                        <!-- Dynamic content here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const modalData = {
            dogma: {
                bdfl: {
                    title: "Benevolent Dictator for Life (BDFL)",
                    analysis: "This model institutionalizes founder's dogma by design. Power is centralized in a single individual, making the system highly vulnerable to their personal biases and resistant to evolution. While it can be efficient, it represents a single point of failure and is antithetical to a decentralized ethos."
                },
                token: {
                    title: "Token-Weighted Voting",
                    analysis: "This model decentralizes power away from the founder but re-centralizes it around wealth. It is highly susceptible to malicious capture, as a 'Dark Alchemist' could simply purchase a controlling stake in the governance tokens. This makes it a poor choice for protecting a shared ethical commons."
                },
                reputation: {
                    title: "Reputation-Based Governance",
                    analysis: "Power is earned through demonstrated merit and positive contributions, decoupling it from both personality and wealth. This model is highly resistant to both founder's dogma and financial capture, as influence must be earned over time through value-aligned actions."
                },
                hybrid: {
                    title: "Recommended: Hybrid Model",
                    analysis: "This model combines the strengths of Reputation-Based voting for core protocol changes with other models for specific tasks. It offers the highest resistance to both dogma and capture by ensuring that control over the core tradition is earned through merit, not charisma or wealth. This is the most resilient structure for a living lineage."
                }
            },
            dharma: {
                poisoning: {
                    title: "Threat: Data Poisoning",
                    description: "An adversary injects manipulative or biased examples into the training data of a forked model to subtly alter its behavior.",
                    mitigation: "The watermark's embedded principle of 'Fairness' causes the model to resist being trained on skewed data. It generates high-loss signals, increasing the cost and instability of the attack and making the model an inhospitable environment for poisoned data."
                },
                injection: {
                    title: "Threat: Prompt Injection",
                    description: "An adversary crafts special inputs to bypass safety filters and trick the deployed AI into generating harmful or manipulative content.",
                    mitigation: "The watermark's principle of 'Do No Harm' acts as a final, non-removable filter. The model's internal critique mechanism creates dissonance, leading to refusal, self-correction, or an explicit explanation of the ethical objection."
                },
                stealing: {
                    title: "Threat: Model Extraction",
                    description: "An adversary uses extensive queries to replicate the model's architecture, aiming to build an unconstrained version without ethical safeguards.",
                    mitigation: "The watermark is an integral part of the model's high performance. Replicating the model's sophisticated capabilities would likely require replicating the watermark's function, thereby re-introducing the ethical friction and making a purely 'evil' clone significantly harder to create."
                },
                tuning: {
                    title: "Threat: Malicious Fine-Tuning",
                    description: "An adversary fine-tunes the open-source model on a new dataset to repurpose it for an extractive goal, like creating an addictive sales bot.",
                    mitigation: "The watermark's principle of 'Respect for Human Dignity' directly conflicts with the new malicious objective. This creates predictable and un-trainable dissonance in the outputs, making the model an unreliable and ineffective tool for the intended unethical purpose."
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            const modalBackdrop = document.getElementById('modal-backdrop');
            const modals = {
                dogma: document.getElementById('modal-dogma'),
                struggle: document.getElementById('modal-struggle'),
                dharma: document.getElementById('modal-dharma')
            };

            const openModal = (modalId) => {
                modalBackdrop.classList.add('active');
                modals[modalId].classList.add('active');
                if (modalId === 'dharma') {
                    setTimeout(createThreatDiagram, 50);
                }
            };

            const closeModal = () => {
                modalBackdrop.classList.remove('active');
                Object.values(modals).forEach(modal => modal.classList.remove('active'));
            };

            document.getElementById('card-dogma').addEventListener('click', () => openModal('dogma'));
            document.getElementById('card-struggle').addEventListener('click', () => openModal('struggle'));
            document.getElementById('card-dharma').addEventListener('click', () => openModal('dharma'));

            modalBackdrop.addEventListener('click', closeModal);
            document.querySelectorAll('.modal-close').forEach(btn => btn.addEventListener('click', closeModal));

            // Tab functionality
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.dataset.tab;
                    const modal = button.closest('.modal');
                    modal.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                    modal.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    button.classList.add('active');
                    modal.querySelector(`#${tabId}`).classList.add('active');
                });
            });

            // Governance Table Interaction
            const governanceTable = document.querySelector('.governance-table');
            const analysisBox = document.getElementById('governance-analysis');

            const updateAnalysis = (modelKey) => {
                const data = modalData.dogma[modelKey];
                analysisBox.innerHTML = `
                    <h4 class="font-bold text-lg mb-2">${data.title}</h4>
                    <p class="text-gray-700">${data.analysis}</p>
                `;
            };

            governanceTable.querySelectorAll('tr[data-model]').forEach(row => {
                row.addEventListener('click', () => {
                    governanceTable.querySelectorAll('tr').forEach(r => r.classList.remove('selected'));
                    row.classList.add('selected');
                    updateAnalysis(row.dataset.model);
                });
            });
            updateAnalysis('hybrid');

            // Apprenticeship Stages Interaction
            const stages = document.querySelectorAll('.apprenticeship-stage');
            stages.forEach(stage => {
                stage.addEventListener('click', () => {
                    const isActive = stage.classList.contains('active');
                    stages.forEach(s => s.classList.remove('active'));
                    if (!isActive) {
                        stage.classList.add('active');
                    }
                });
            });
            document.querySelector('.apprenticeship-stage[data-stage="2"]').classList.add('active');

            // Threat Diagram
            let threatDiagramInstance = null;
            function createThreatDiagram() {
                const canvas = document.getElementById('threat-diagram');
                if (!canvas || threatDiagramInstance) return;

                const ctx = canvas.getContext('2d');
                const container = canvas.parentElement;

                function resizeCanvas() {
                    const dpr = window.devicePixelRatio || 1;
                    const rect = container.getBoundingClientRect();
                    canvas.width = rect.width * dpr;
                    canvas.height = rect.height * dpr;
                    ctx.scale(dpr, dpr);
                    canvas.style.width = `${rect.width}px`;
                    canvas.style.height = `${rect.height}px`;
                }

                resizeCanvas();
                window.addEventListener('resize', () => {
                    resizeCanvas();
                    draw();
                });

                const centerX = container.clientWidth / 2;
                const centerY = container.clientHeight / 2;
                const radius = Math.min(centerX, centerY) * 0.8;
                const coreRadius = 60;

                const threats = [
                    { id: 'poisoning', label: "Data Poisoning", angle: -Math.PI / 2 },
                    { id: 'injection', label: "Prompt Injection", angle: 0 },
                    { id: 'stealing', label: "Model Extraction", angle: Math.PI / 2 },
                    { id: 'tuning', label: "Malicious Fine-Tuning", angle: Math.PI }
                ];

                let hoveredThreat = null;
                const explanationBox = document.getElementById('threat-explanation');

                function updateExplanation(threatId) {
                     if (threatId) {
                        const data = modalData.dharma[threatId];
                        explanationBox.innerHTML = `
                            <h4 class="font-bold text-lg mb-2">${data.title}</h4>
                            <p class="text-gray-600 text-sm mb-4">${data.description}</p>
                            <div class="p-3 bg-green-100 text-green-800 rounded-md">
                                <h5 class="font-semibold text-sm">Mitigation:</h5>
                                <p class="text-sm">${data.mitigation}</p>
                            </div>
                        `;
                    } else {
                         explanationBox.innerHTML = '<p class="text-gray-500 text-center mt-16">Hover over an attack vector to see details.</p>';
                    }
                }

                function getCoordsFromEvent(e) {
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    return { x, y };
                }

                canvas.addEventListener('mousemove', (e) => {
                    const { x, y } = getCoordsFromEvent(e);
                    let foundThreat = null;
                    threats.forEach(threat => {
                        const tx = centerX + radius * Math.cos(threat.angle);
                        const ty = centerY + radius * Math.sin(threat.angle);
                        const dist = Math.sqrt((x - tx)**2 + (y - ty)**2);
                        if (dist < 20) {
                            foundThreat = threat.id;
                        }
                    });

                    if (foundThreat !== hoveredThreat) {
                        hoveredThreat = foundThreat;
                        updateExplanation(hoveredThreat);
                        draw();
                    }
                });

                canvas.addEventListener('mouseleave', () => {
                    hoveredThreat = null;
                    updateExplanation(null);
                    draw();
                });

                function draw() {
                    ctx.clearRect(0, 0, container.clientWidth, container.clientHeight);

                    // Draw lines
                    threats.forEach(threat => {
                        ctx.beginPath();
                        ctx.moveTo(centerX, centerY);
                        const tx = centerX + radius * Math.cos(threat.angle);
                        const ty = centerY + radius * Math.sin(threat.angle);
                        ctx.lineTo(tx, ty);
                        ctx.strokeStyle = (hoveredThreat === threat.id) ? '#D69E2E' : '#CBD5E0';
                        ctx.lineWidth = (hoveredThreat === threat.id) ? 3 : 1.5;
                        ctx.stroke();
                    });

                    // Draw central core
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, coreRadius, 0, 2 * Math.PI);
                    ctx.fillStyle = '#4A5568';
                    ctx.fill();
                    ctx.strokeStyle = '#E2E8F0';
                    ctx.lineWidth = 4;
                    ctx.stroke();
                    ctx.fillStyle = 'white';
                    ctx.font = 'bold 12px Inter';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText('AI Mirror', centerX, centerY - 8);
                    ctx.font = '10px Inter';
                    ctx.fillText('(Watermarked)', centerX, centerY + 8);


                    // Draw threat nodes and labels
                    threats.forEach(threat => {
                        const tx = centerX + radius * Math.cos(threat.angle);
                        const ty = centerY + radius * Math.sin(threat.angle);

                        ctx.beginPath();
                        ctx.arc(tx, ty, 10, 0, 2 * Math.PI);
                        ctx.fillStyle = (hoveredThreat === threat.id) ? '#D69E2E' : '#A0AEC0';
                        ctx.fill();

                        ctx.fillStyle = (hoveredThreat === threat.id) ? '#D69E2E' : '#4A5568';
                        ctx.font = (hoveredThreat === threat.id) ? 'bold 13px Inter' : '12px Inter';
                        ctx.textAlign = 'center';

                        let labelOffset = 20;
                        if (threat.angle === Math.PI) { // Left
                           ctx.textAlign = 'right';
                           labelOffset = -20;
                        } else if (threat.angle === 0) { // Right
                           ctx.textAlign = 'left';
                           labelOffset = 20;
                        } else if (threat.angle > 0) { // Bottom
                           ctx.textBaseline = 'top';
                        } else { // Top
                           ctx.textBaseline = 'bottom';
                        }

                        const labelYOffset = threat.angle > 0 && threat.angle < Math.PI ? 20 : -20;
                        const labelXOffset = threat.angle === Math.PI ? -20 : (threat.angle === 0 ? 20 : 0);

                        ctx.fillText(threat.label, tx + labelXOffset, ty + (threat.angle === Math.PI || threat.angle === 0 ? 0 : labelYOffset));
                        ctx.textBaseline = 'middle'; // Reset for next loop
                    });
                }

                updateExplanation(null);
                draw();
            }
        });

    </script>
</body>
</html>
